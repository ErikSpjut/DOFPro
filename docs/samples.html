<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DOFPro group">

<title>Degrees of Freedom Project - Samples of Needed Abilities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Degrees of Freedom Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ChemE.html"> 
<span class="menu-text">Chemical and Thermal Processes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Rocketry.html"> 
<span class="menu-text">Rocketry</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./samples.html" aria-current="page"> 
<span class="menu-text">Samples</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#scripts" id="toc-scripts" class="nav-link" data-scroll-target="#scripts">Scripts</a></li>
  <li><a href="#graphics-production" id="toc-graphics-production" class="nav-link" data-scroll-target="#graphics-production">Graphics Production</a></li>
  <li><a href="#recording-and-editing" id="toc-recording-and-editing" class="nav-link" data-scroll-target="#recording-and-editing">Recording and Editing</a></li>
  <li><a href="#website-production" id="toc-website-production" class="nav-link" data-scroll-target="#website-production">Website Production</a></li>
  <li><a href="#problem-set-and-example-conversion" id="toc-problem-set-and-example-conversion" class="nav-link" data-scroll-target="#problem-set-and-example-conversion">Problem Set and Example Conversion</a></li>
  <li><a href="#software-and-cad-conversion" id="toc-software-and-cad-conversion" class="nav-link" data-scroll-target="#software-and-cad-conversion">Software and CAD Conversion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Samples of Needed Abilities</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DOFPro group </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Would you like to contribute to the Degrees of Freedom Project? We have need of people with skills in the areas listed below. Please choose two of the sample tasks, e.g., Number 2 under <a href="#scripts">Scripts</a>, and Number 1 under <a href="#software-and-cad-conversion">Software and CAD Conversion</a>, and submit a sample of your work to us for each of your two chosen tasks.</p>
</section>
<section id="scripts" class="level1">
<h1>Scripts</h1>
<p>The prinicipal tasks in the area of scripts are rewriting existing scripts, writing new scripts, and editing existing scripts, and storyboarding. The available sample tasks are:</p>
<ol type="1">
<li>Rewrite the <a href="https://docs.google.com/document/d/14jiiQX4kGKEZr4u8jBO5d_Q_pVHwRp6kV3PYBKQMs10/edit?usp=sharing">linked portion of this script</a> for <a href="https://youtu.be/ywIUp9uNmY8?si=kmD1Ufa5Vz_kGzdG">an existing video</a> to make it clearer and more accessible to students trying to learn chemical and thermal process principles. You may assume that the visuals can be changed.</li>
<li>Write a short script for a video to explain <em>either</em> the differences among total internal energy <span class="math inline">\((U)\)</span>, specific internal energy <span class="math inline">\((\hat{U})\)</span>, and molar internal energy <span class="math inline">\((\hat{U})\)</span> in Chemical Engineering, <em>or</em> the coefficient of drag, <span class="math inline">\(C_D\)</span> for a rocket.</li>
<li>Recommend some edits to the <a href="https://docs.google.com/document/d/10n3r-hAi042YS5q6NA-e9l59_gJjjtlMWoEBPm5B5H4/edit?usp=sharing">linked script</a> to make it clearer and more accessible to students trying to learn chemical and thermal process principles.</li>
<li>Storyboard the <a href="https://docs.google.com/document/d/10n3r-hAi042YS5q6NA-e9l59_gJjjtlMWoEBPm5B5H4/edit?usp=sharing">linked script</a>.</li>
</ol>
</section>
<section id="graphics-production" class="level1">
<h1>Graphics Production</h1>
<p>Graphics Production involves many aspect of the project. We need title screens for the videos, logos for the videos and the websites, storyboards for the scripts, creation of the visuals for the videos and websites, and other elements of the graphic design for the websites and videos. The available sampel tasks are:</p>
<ol type="1">
<li>Create an overall logo for <a href="./index.html">DOFPro</a>.</li>
<li>Create a logo for the <a href="https://erik.spjut.me/CTP/">Chemical and Thermal Processes website</a>.</li>
<li>Create a logo for the <a href="https://erik.spjut.me/RCK/">Rocketry website</a>.</li>
<li>Create a title screen for the <a href="https://docs.google.com/document/d/10n3r-hAi042YS5q6NA-e9l59_gJjjtlMWoEBPm5B5H4/edit?usp=sharing"><em>What Is a Mole?</em></a> video.</li>
<li>Create a reveal.js presentation for slides 3 and 4 (page 2) of the <a href="https://pages.hmc.edu/spjut/E82/lec/ConvertingTemperature.pdf">linked presentation</a>.</li>
<li>Recreate the process flow diagram (PFD) in the <a href="https://drive.google.com/file/d/1nFTj78bRb23Jkb39tgxb18pixNyBRfBJ/view?usp=sharing">linked problem</a> with your choice of open-source software.</li>
<li>Create a 2D animation of the process flow diagram (PFD) in the <a href="https://drive.google.com/file/d/1nFTj78bRb23Jkb39tgxb18pixNyBRfBJ/view?usp=sharing">linked problem</a>. Have the reactor, heat exchanger, and distillation columns dissolve in one-by-one, and then the flow streams, and then trace the flow of propylene through the flow sterams and processing units.</li>
<li>Create a 3D animation of a tank with a feed pipe filling with a liquid.</li>
</ol>
</section>
<section id="recording-and-editing" class="level1">
<h1>Recording and Editing</h1>
<p>We have a large number of videos to record and all aspects of the recording and editing process will need to be done: lighting, staging, setting up sound equipment, operating the cameras, acting, editing the videos, editing the audio, mastering and final production, and posting. The available sample projects are:</p>
<ol type="1">
<li>Light and photograph an interesting object.</li>
<li>Create a prop for use in a chemical and thermal processes or rocketry video.</li>
<li>Record a short video of someone explaining what internal energy is and include at least one transition.</li>
<li>Record a short video of someone singing, then optimize the sound quality, e.g, use an expander to drop the noise floor, a compressor to narrow the dynamic range, an equalizer to balance the frequency response, and some reverb to enhance the sound (just to clarify, <em>e.g.</em> means <em>for example</em>, it does not mean <em>in other words</em>).</li>
<li>Make a short video that shows proper use of at least three of the following:
<ol type="1">
<li>Standard cut</li>
<li>Jump cut</li>
<li>Crossfade</li>
<li>Wipe</li>
<li>J- or L-cut</li>
<li>Fade-in or fade-out</li>
</ol></li>
<li>Make short audio recording of someone speaking in a noisy environment and provide before-and-after samples of applying compression and expansion and/or other effects to optimize the noise reduction and audio quality. Explain how you did it.</li>
</ol>
</section>
<section id="website-production" class="level1">
<h1>Website Production</h1>
<p>We are creating and editing the websites in <a href="https://quarto.org/">Quarto</a> and posting on <a href="https://github.com/">github</a>. <a href="https://code.visualstudio.com/">VS Code</a> is the recommended development environment. Quarto uses <a href="https://quarto.org/docs/authoring/markdown-basics.html">Markdown</a> for most of the text editing and Mathjax (<a href="https://quarto.org/docs/visual-editor/vscode/">LaTeX</a>) for equation editing. We are creating our presentations in <a href="https://quarto.org/docs/presentations/">Quarto</a> using the <a href="https://quarto.org/docs/presentations/revealjs/">revealjs</a> format. The sample tasks in website production are:</p>
<ol type="1">
<li>Convert the <a href="https://pages.hmc.edu/spjut/AdvRoc/Assignments/assign2.md.html">linked webpage</a> into a Quarto “.qmd” document that will render correctly (but not necessarily identially). Adding “?noformat” to the end of the URL may make your task much easier.</li>
<li>Convert the linked presentation (<a href="https://drive.google.com/file/d/1nMHzHLIgjeySL0xoDJYO1G8apgomf16m/view?usp=sharing">PDF version</a>) (<a href="https://drive.google.com/file/d/1nPe37luqQcUPC2H708ImQyVFIqez8zIg/view?usp=sharing">Keynote version</a>) (<a href="https://docs.google.com/presentation/d/1nPZXmdBwtF7BFUtV85Qhc5aCEjdvS1Py/edit?usp=sharing&amp;ouid=107710122838944141135&amp;rtpof=true&amp;sd=true">Powerpoint version</a>) to a <a href="https://quarto.org/docs/presentations/revealjs/">Quarto presentation using the revealjs format</a> and render it in PDF.</li>
<li>Using css, change the linked webpage (<a href="https://erik.spjut.me/E106_Website/index.html">link</a>) (<a href="https://drive.google.com/file/d/1nPjYnUJe_a3PVU6nTFEwlGsi2ZRrQktc/view?usp=sharing">source</a>) so that the table values are in a red serif font and the links are in a green italics serif font.</li>
<li>Provide a step-by-step expalation of how you would set up and organize a team to use Quarto and Github with VS Code collaboratively edit a website and track all changes to the code base.</li>
</ol>
</section>
<section id="problem-set-and-example-conversion" class="level1">
<h1>Problem Set and Example Conversion</h1>
<p>Many of the example problems, homework problems, and projects are currently tied to copyrighted textbooks and commercial software. All of them need to be converted to problems releasable under creative commons and reference open-source software. The sample tasks in this section are:</p>
<ol type="1">
<li>Either convert or describe the process for converting the linked assignment (<a href="https://docs.google.com/document/d/1nST5n3O6RKP3-XpkhjhjQ2NglH3TLahz/edit?usp=sharing&amp;ouid=107710122838944141135&amp;rtpof=true&amp;sd=true">.docx</a>) (<a href="https://drive.google.com/file/d/1nSTXlFfWVonpvk_pxxD7KwD3-44lDsSX/view?usp=sharing">.pdf</a>) to be releasable under creative commons.</li>
<li>Either convert or describe the process for converting the example in Slides 14 through 18 (<a href="https://pages.hmc.edu/spjut/E82/lec/FirstLawHeatCapacities.pdf">slides</a>) (<a href="https://youtu.be/6qpFuS_3CrY">video</a> starting at 10:08) to be releasable under creative commons.</li>
<li>Either convert or describe the process for converting the <a href="https://pages.hmc.edu/spjut/E133/FinProj.md.html">linked project</a> to be releasable under creative commons.</li>
</ol>
</section>
<section id="software-and-cad-conversion" class="level1">
<h1>Software and CAD Conversion</h1>
<p>We have lots of example solutions, assignment solutions, projects, and CAD files that need to be converted from commercial software to open source. We have decided that we are going to make the following conversions:</p>
<ol type="1">
<li>Microsoft Excel files to LibreOffice files</li>
<li>MATLAB code to Python with NumPy and SciPy code</li>
<li>Mathematica code to SageMath code</li>
<li>Solidworks files to FreeCAD files</li>
<li>PRO/II files to DWSIM files.</li>
</ol>
<p>The sample projects available in software and CAD conversion are:</p>
<ol type="1">
<li>Convert the <a href="https://docs.google.com/spreadsheets/d/1naKkSAOtSbSEQx4Ca7cpSpqCI31pCggf/edit?usp=sharing&amp;ouid=107710122838944141135&amp;rtpof=true&amp;sd=true">linked spreadsheet</a> from a “.xlsx” file to a “.ods” file and preserve as much of the formatting as possible.</li>
<li>Convert the <a href="https://drive.google.com/file/d/1nc3Nyd5rjPG1jp8DpVo4FfOBpHN0D-wd/view?usp=sharing">linked “.m” file</a> into a “.py” file. The data file it processes is <a href="https://drive.google.com/file/d/1ne-k_LvOX2ae1Ot23gb_Pgzpw4aT8vfU/view?usp=sharing">linked here</a>.</li>
<li>Convert the <a href="https://drive.google.com/file/d/1nkY3Uw0mS3nqiFPQYPgbHJmhizsgYgvS/view?usp=sharing">linked “.nb” file</a> into SageMath code.</li>
<li>Convert the <a href="https://drive.google.com/file/d/1nkgtu4yxQ6RoPLs3ljCx3XqANtPwT4i4/view?usp=sharing">linked “.SLDPRT” file</a> into an “FCStd” file.</li>
<li>Convert the linked “.prz” to a “.dwxmz” file.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>